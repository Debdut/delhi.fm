(()=>{"use strict";function t(...t){if(0===t.length)return;const e={};let i,s,a;if(t.forEach(((t,n)=>{const i="string"==typeof(s=t)?"string":"object"==typeof s?Array.isArray(s)?"array":s instanceof Element?"element":"object":void 0;var s;e[i]?e[i].push(n):e[i]=[n]})),e.array&&(i=e.array[0],s=t[i]),e.object&&(i=e.object[0],a=t[i]),e.element&&e.element.length>0){i=e.element[0];const o=t[i];let r;return e.string&&(i=e.string[0],r=t[i]),n(o,a,r,s)}if(e.string&&e.string.length>0){i=e.string[0];const o=t[i];let r;return e.string.length>1&&(i=e.string[1],r=t[i]),function(t,e,i,s){return n(document.createElement(t),e,i,s)}(o,a,r,s)}}function n(t,n={},e,i=[]){for(const e in n)if(Object.hasOwnProperty.call(n,e)){const i=n[e];t[e]=i}e&&(t.innerText=e);for(let n=0;n<i.length;n++){const e=i[n];e instanceof Node&&t.appendChild(e)}return t}function e(){const t=document.querySelector("header span.action");t&&("▶️"===t.innerText?t.innerText="⏸":t.innerText="▶️")}window.addEventListener("load",(async function(){const t=await async function(){return(await fetch("albums.json")).json()}(),n=document.body;new i(t,n,e,s)}));class i{constructor(t,n,e,i){this.albums=t,this.audios=[],this.albumN=2,this.trackN=0,this.onToggle=e,this.onAlbumChange=i,this.loadTrack(),this.onAlbumChange(this.album);const s=this;n.addEventListener("click",(function(){s.toggle()})),n.addEventListener("keypress",(function(t){"Space"===t.code&&s.toggle()})),n.addEventListener("touch",(function(){s.toggle()}))}toggle(){this.on?this.pause():this.play(),this.onToggle(),this.on=!this.on}loadTrack(t,n){t&&(this.albumN=t),n&&(this.trackN=n);const e=this.album.tracks[this.trackN].path,i=new Audio(e);this.audios.push(i)}unloadTrack(){return this.audios.shift()}nextTrack(){let t=this.album.tracks.length;this.trackN===t-1?(this.trackN=0,this.nextAlbum()):this.trackN+=1}nextAlbum(){let t=this.albums.length;this.albumN===t?this.albumN=0:(this.albumN+=1,this.onAlbumChange(this.album))}get album(){return this.albums[this.albumN]}play(){this.audio||(this.audio=this.unloadTrack(),this.nextTrack(),this.loadTrack());const t=this,n=this.audio;n.play(),n.addEventListener("ended",(function e(){n.removeEventListener("ended",e),delete t.audio,t.play()}))}pause(){this.audio&&this.audio.pause()}}function s(n){const e=function(n){return t("div",{className:"player-view"},[t("img",{src:n.cover}),t("h2",n.title)])}(n);document.body.appendChild(e)}})();