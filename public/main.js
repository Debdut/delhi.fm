(()=>{window.addEventListener("load",(async function(){const s=await async function(){return(await fetch("albums.json")).json()}(),a=document.body;new t(s,a)}));class t{constructor(t,s){this.albums=t,this.audios=[],this.albumN=2,this.trackN=0,this.loadTrack();const a=this;s.addEventListener("click",(function(){a.toggle()})),s.addEventListener("keypress",(function(t){"Space"===t.code&&a.toggle()}))}toggle(){this.on?this.pause():this.play(),this.on=!this.on}loadTrack(t,s){t&&(this.albumN=t),s&&(this.trackN=s);const a=this.albums[this.albumN].tracks[this.trackN].path,i=new Audio(a);this.audios.push(i)}unloadTrack(){return this.audios.shift()}nextTrack(){let t=this.albums[this.albumN].tracks.length;this.trackN===t-1?(this.trackN=0,this.nextAlbum()):this.trackN+=1}nextAlbum(){let t=this.albums.length;this.albumN===t?this.albumN=0:this.albumN+=1}play(){console.log("play"),this.audio||(this.audio=this.unloadTrack(),this.nextTrack(),this.loadTrack());const t=this,s=this.audio;s.play(),s.addEventListener("ended",(function a(){s.removeEventListener("ended",a),delete t.audio,t.play()}))}pause(){console.log("pause"),this.audio&&this.audio.pause()}}})();